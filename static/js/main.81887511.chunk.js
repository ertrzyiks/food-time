(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,a,t){e.exports=t(152)},125:function(e,a,t){},151:function(e,a,t){},152:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(13),i=t.n(c),o=(t(125),t(22)),l=t(39),m=t(38),u=t(67),s=t(41),d=t(112),f=t(30),b=t(31),p=t.n(b),E=t(214),g=t(202),v=t(203),h=t(204),O=t(52),j=t(205),y=t(51),w=t.n(y),x=t(115),N=t(206),k=t(207),I=t(197),S=t(195),C=t(196),D=t(208),$=t(192),_=t(216),z=t(194),A=Object($.a)(function(e){return{error:{backgroundColor:e.palette.error.dark}}}),F=function(e){var a=e.message,t=Object(n.useState)(!0),c=Object(o.a)(t,2),i=c[0],l=c[1],m=A();if(!a)return null;function u(e,a){"clickaway"!==a&&l(!1)}return r.a.createElement(_.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:6e3,onClose:u,open:i},r.a.createElement(z.a,{className:m.error,message:a.toString(),onClose:u}))},M=t(200),R=t(198),T=t(199),W=t(201),L=t(100),q=t.n(L),B=t(98),H=t.n(B),G=t(56),J=t(95),P=t(96);function Q(e){return Object(G.a)(new Date(e),"HH:mm")}function U(e,a){var t=Object(J.a)(e,a),n=Object(P.a)(e,a)%60;return n<10&&(n="0".concat(n)),"".concat(t,":").concat(n,"h")}var K=t(97);var V=Object($.a)(function(e){return{item:{opacity:.3},root:{backgroundColor:e.palette.background.paper},subheader:{backgroundColor:"#ead3d3",textAlign:"left"},subheader_total:{float:"right"},icon:{flexDirection:"column",fontSize:12}}}),X=function(e){var a=e.time,t=e.key,c=Object(n.useState)(0),i=Object(o.a)(c,2),l=i[0],m=i[1];!function(e,a){var t=Object(n.useRef)();Object(n.useEffect)(function(){t.current=e},[e]),Object(n.useEffect)(function(){if(null!==a){var e=setInterval(function(){t.current()},a);return function(){return clearInterval(e)}}},[a])}(function(){m(l+1)},15e3);var u=Date.now(),s=V(),d=new Date(1e3*a);return r.a.createElement(S.a,{key:t,className:s.item},r.a.createElement(C.a,{primary:"Next at ".concat(Q(d)),secondary:d>u&&U(d,u)}))},Y=function(e){var a=e.groupedEntries,t=Date.now(),n=V();return r.a.createElement(I.a,{disablePadding:!0,className:n.root},Object.entries(a).map(function(e){var a=Object(o.a)(e,2),c=a[0],i=a[1];return r.a.createElement(K.CSSTransitionGroup,{key:c,transitionName:"example",transitionEnterTimeout:500,transitionLeaveTimeout:300},r.a.createElement(R.a,{className:n.subheader},Object(G.a)(parseInt(c,10),"d MMM, yyyy"),r.a.createElement("span",{className:n.subheader_total},"(total ",function(e){return e.filter(function(e){return!e.isSuggested}).length}(i),")")),i.map(function(e){var a=e.id,c=e.time,i=e.extra_food,o=e.meantime;return e.isSuggested?r.a.createElement(X,{key:a,time:c}):r.a.createElement(S.a,{key:a},r.a.createElement(T.a,{className:n.icon},i>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,null)," ",i,"ml"):null),r.a.createElement(C.a,{secondary:o},Q(1e3*c)),r.a.createElement(M.a,null,t-1e3*c<864e5&&r.a.createElement(W.a,{edge:"end","aria-label":"Comments",component:l.b,to:"/edit/".concat(a)},r.a.createElement(q.a,null))))}))}))},Z=t(106),ee=t(47);function ae(){var e=Object(f.a)(["\n  query getEntries($spaceId: String!) {\n    entries(spaceId: $spaceId) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return ae=function(){return e},e}var te=p()(ae());function ne(){var e=Object(f.a)(["\n  query getEntry($id: String!) {\n    entry(id: $id) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return ne=function(){return e},e}var re=p()(ne());function ce(){var e=Object(f.a)(["\n  mutation UpdateEntry($id: String!, $time: Int, $extra_food: Int) {\n    updateEntry(id: $id, time: $time, extra_food: $extra_food) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return ce=function(){return e},e}var ie=p()(ce());function oe(){var e=Object(f.a)(["\n  mutation RemoveEntry($id: String!) {\n    removeEntry(id: $id) {\n      message\n      removedId\n    }\n  }\n"]);return oe=function(){return e},e}var le=p()(oe());function me(){var e=Object(f.a)(["\n  mutation CreateEntry($spaceId: String!, $time: Int!) {\n    createEntry(spaceId: $spaceId, time: $time) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return me=function(){return e},e}var ue=p()(me()),se=Object($.a)(function(e){return{appBar:{backgroundColor:"#3e4451"},avatar:{margin:15,width:40,height:40},toolbar:{justifyContent:"space-between",height:70},title:{margin:15},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2),zIndex:2},listWrapper:{marginTop:e.spacing(2)}}});var de=function(e){var a=e.spaceId,t=e.profile,n=se(),c=Object(E.a)(te,{variables:{spaceId:a}}),i=c.loading,l=c.data,m=c.error,u=!i&&!m,f=Object(g.a)(ue,{refetchQueries:["getEntries"]}),b=Object(o.a)(f,2),p=b[0],y=b[1],$=y.loading,_=y.error,z=u&&l.entries.slice().sort(function(e,a){return a.time-e.time}),A=u&&z.reverse().reduce(function(e,a){if(e.length>0){var t=e[e.length-1];return[].concat(Object(d.a)(e),[Object(s.a)({},a,{meantime:U(new Date(1e3*a.time),new Date(1e3*t.time))})])}return[Object(s.a)({},a,{meantime:null})]},[]).reverse();if(A.length>0){var M=A[0],R=new Date(1e3*M.time),T=R.getHours(),W=T>=21||T<3?240:210;A.unshift({id:"future",time:Math.round(Object(ee.a)(R,W)/1e3),extra_food:0,meantime:null,isSuggested:!0})}var L=A&&A.reduce(function(e,a){var t=Object(Z.a)(new Date(1e3*a.time)).getTime();return e[t]=e[t]||[],e[t].push(a),e},{});return r.a.createElement(r.a.Fragment,null,(m||_)&&r.a.createElement(F,{message:m||_}),r.a.createElement(v.a,{className:n.appBar},r.a.createElement(h.a,{disableGutters:!0,className:n.toolbar},r.a.createElement(O.a,{variant:"h5",className:n.title},"Food time"),r.a.createElement(j.a,{alt:"Profile picture",src:t.imageUrl,className:n.avatar}))),r.a.createElement(h.a,{className:n.toolbar}),r.a.createElement(N.a,{className:n.listWrapper,maxWidth:"sm"},r.a.createElement(k.a,{variant:"extended",color:"primary","aria-label":"delete",className:n.fab,onClick:function(){return p({variables:{time:Math.round(Date.now()/1e3),spaceId:a}})},disabled:$},r.a.createElement(w.a,{className:n.extendedIcon}),"New feeding"),!i&&!m&&r.a.createElement(x.a,null,!i&&l&&l.entries.length>0&&r.a.createElement(Y,{groupedEntries:L}),!i&&l&&0===l.entries.length&&r.a.createElement(I.a,null,r.a.createElement(S.a,null,r.a.createElement(C.a,{primary:"Click the button to start measuring intervals"})))),i&&r.a.createElement(D.a,null)))},fe=t(212),be=t(210),pe=t(209);var Ee=function(e){var a=e.onSelect,t=Object(n.useState)(""),c=Object(o.a)(t,2),i=c[0],l=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"}),r.a.createElement("form",{onSubmit:function(){return a(i)}},r.a.createElement(pe.a,{container:!0,spacing:5,direction:"column"},r.a.createElement(pe.a,{item:!0},r.a.createElement(fe.a,{label:"Space name",value:i,onChange:function(e){return l(e.target.value)},margin:"normal"})),r.a.createElement(pe.a,{item:!0},r.a.createElement(be.a,{type:"submit",variant:"contained",color:"primary"},"Proceed")))))},ge=t(107),ve=function(e){var a=e.onLogin,t=function(e){console.log(e),a(e)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"}),r.a.createElement(ge.GoogleLogin,{clientId:"299114443733-g59vv11262camtp97hiv99sjh0qr3b9i.apps.googleusercontent.com",buttonText:"Login",onSuccess:t,onFailure:t,isSignedIn:!0,cookiePolicy:"single_host_origin"}))},he=t(110),Oe=t(109),je=t(71),ye=t(70),we=t(108),xe=t(217),Ne=t(72),ke=t.n(Ne),Ie=t(215);function Se(e){var a=null,t=!1;return function(){for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];t?a=function(){return e.apply(void 0,r)}:function e(n){t=!0,n().then(function(){if(t=!1,null!=a){var n=a;a=null,e(n)}})}(function(){return e.apply(void 0,r)})}}var Ce=Object($.a)(function(e){return Object(Ie.a)({root:{padding:e.spacing(3,5)}})});var De=function(e){var a=e.spaceId,t=e.match.params.id,c=Object(E.a)(re,{variables:{id:t}}),i=c.loading,l=c.data,d=Object(g.a)(le,{variables:{id:t},update:function(e,t){var n=t.data.removeEntry,r=null;try{r=e.readQuery({query:te,variables:{spaceId:a}})}catch(c){}r&&e.writeQuery({query:te,variables:{spaceId:a},data:{entries:r.entries.filter(function(e){return e.id!==n.removedId})}})}}),f=Object(o.a)(d,2),b=f[0],p=f[1].data,v=Object(n.useState)(null),h=Object(o.a)(v,2),j=h[0],y=h[1],I=Object(n.useState)(null),S=Object(o.a)(I,2),C=S[0],$=S[1],_=Object(u.b)(),z=Object(n.useCallback)(Se(function(e){return _.mutate({mutation:ie,variables:Object(s.a)({id:t},e)})}),[_,t]);null!==j||i||y(new Date(1e3*l.entry.time)),null!==C||i||$(l.entry.extra_food);var A,F=function(e){y(e),z({time:Math.round(e.getTime()/1e3)})},M=Ce();return p?r.a.createElement(m.a,{to:"/"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"},!i&&r.a.createElement(O.a,null,Q(j)," ",(A=j,Object(G.a)(new Date(A),"d MMM, yyyy")))),r.a.createElement(N.a,{maxWidth:"sm"},i?r.a.createElement(D.a,null):r.a.createElement(pe.a,{container:!0,spacing:2,direction:"row",justify:"center"},r.a.createElement(pe.a,{item:!0,xs:12,md:4},r.a.createElement(x.a,{className:M.root},r.a.createElement(O.a,{paragraph:!0},"Day"),r.a.createElement(k.a,{color:"primary","aria-label":"Add",size:"small",onClick:function(){return F(Object(ye.a)(j,1))}},r.a.createElement(w.a,null)),r.a.createElement(k.a,{color:"primary","aria-label":"Remove",size:"small",onClick:function(){return F(Object(we.a)(j,1))}},r.a.createElement(ke.a,null)))),r.a.createElement(pe.a,{item:!0,xs:12,md:4},r.a.createElement(x.a,{className:M.root},r.a.createElement(O.a,{paragraph:!0},"Hours"),r.a.createElement(k.a,{color:"primary","aria-label":"Add",size:"small",onClick:function(){return F(Object(je.a)(j,1))}},r.a.createElement(w.a,null)),r.a.createElement(k.a,{color:"primary","aria-label":"Remove",size:"small",onClick:function(){return F(Object(Oe.a)(j,1))}},r.a.createElement(ke.a,null)))),r.a.createElement(pe.a,{item:!0,xs:12,md:4},r.a.createElement(x.a,{className:M.root},r.a.createElement(O.a,{paragraph:!0},"Minutes"),r.a.createElement(k.a,{color:"primary","aria-label":"Add",size:"small",onClick:function(){return F(Object(ee.a)(j,5))}},r.a.createElement(w.a,null)),r.a.createElement(k.a,{color:"primary","aria-label":"Remove",size:"small",onClick:function(){return F(Object(he.a)(j,5))}},r.a.createElement(ke.a,null)))),r.a.createElement(pe.a,{item:!0,xs:12,md:12},r.a.createElement(x.a,{className:M.root},r.a.createElement(O.a,{paragraph:!0},"Extra food - ",C,"ml"),r.a.createElement(xe.a,{defaultValue:C,"aria-labelledby":"discrete-slider",valueLabelDisplay:"off",step:5,min:0,max:150,onChange:function(e,a){return function(e){$(e),z({extra_food:e})}(a)}}))),r.a.createElement(pe.a,{item:!0,xs:12,md:12},r.a.createElement(x.a,{className:M.root},r.a.createElement(O.a,{paragraph:!0},"Danger zone"),r.a.createElement(be.a,{variant:"contained",color:"secondary",onClick:b},"Delete"))))))},$e=t(211),_e=Object($.a)(function(e){return Object(Ie.a)({root:{padding:e.spacing(5,2)}})}),ze=function(){var e=_e();return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"},"ERROR 404"),r.a.createElement(N.a,{className:e.root,maxWidth:"sm"},r.a.createElement(O.a,{variant:"h5",paragraph:!0},"NOT FOUND"),r.a.createElement(O.a,{variant:"body"},"Go back to the ",r.a.createElement($e.a,{to:"/",component:l.b},"homepage"))))},Ae=t(46),Fe=t(114),Me=t(113),Re=t(111);function Te(e){var a=Object(Fe.a)({uri:"https://papi.ertrzyiks.me/food-time"}),t=Object(Re.a)(function(a,t){var n=t.headers;return{headers:Object(s.a)({},n,{authorization:"Bearer ".concat(e)})}});return new Ae.a({cache:new Me.a({cacheRedirects:{Query:{entry:function(e,a,t){return(0,t.getCacheKey)({__typename:"Entry",id:a.id})}}}}),link:t.concat(a)})}t(151);var We=function(e){var a=e.storage,t=a.read,c=a.write,i=Object(n.useState)(t("food-time-space-id")),s=Object(o.a)(i,2),d=s[0],f=s[1],b=Object(n.useState)(null),p=Object(o.a)(b,2),E=p[0],g=p[1];return Object(n.useEffect)(function(){c("food-time-space-id",d)},[d,c]),r.a.createElement("div",{className:"App"},r.a.createElement(l.a,null,r.a.createElement(m.d,null,E?r.a.createElement(u.a,{client:Te(E.tokenId)},d?r.a.createElement(r.a.Fragment,null,r.a.createElement(m.b,{exact:!0,path:"/",render:function(){return r.a.createElement(de,{spaceId:d,profile:E.profileObj})}}),r.a.createElement(m.b,{path:"/edit/:id",render:function(e){return r.a.createElement(De,Object.assign({},e,{spaceId:d}))}})):r.a.createElement(m.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(Ee,Object.assign({},e,{onSelect:function(e){return f(e)}}))}})):r.a.createElement(m.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(ve,Object.assign({},e,{onLogin:function(e){return g(e)}}))}}),r.a.createElement(m.b,{component:ze}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(We,{storage:{read:function(e){return JSON.parse(window.localStorage.getItem(e))},write:function(e,a){return window.localStorage.setItem(e,JSON.stringify(a))}}}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[120,1,2]]]);
//# sourceMappingURL=main.81887511.chunk.js.map