(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,t,a){e.exports=a(152)},125:function(e,t,a){},151:function(e,t,a){},152:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),i=a.n(c),o=(a(125),a(22)),l=a(39),u=a(38),m=a(66),s=a(41),d=a(112),f=a(30),E=a(31),b=a.n(E),p=a(208),g=a(199),v=a(200),h=a(154),O=a(201),y=a(194),j=a(192),w=a(193),k=a(202),x=a(210),S=a(191),I=a(189),N=Object(I.a)(function(e){return{error:{backgroundColor:e.palette.error.dark}}}),C=function(e){var t=e.message,a=Object(n.useState)(!0),c=Object(o.a)(a,2),i=c[0],l=c[1],u=N();if(!t)return null;function m(e,t){"clickaway"!==t&&l(!1)}return r.a.createElement(x.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:6e3,onClose:m,open:i},r.a.createElement(S.a,{className:u.error,message:t.toString(),onClose:m}))},D=a(197),$=a(195),_=a(196),z=a(198),A=a(100),M=a.n(A),F=a(98),R=a.n(F),T=a(55),L=a(95),q=a(96);function H(e){return Object(T.a)(new Date(e),"HH:mm")}function W(e,t){var a=Object(L.a)(e,t),n=Object(q.a)(e,t)%60;return n<10&&(n="0".concat(n)),"".concat(a,":").concat(n,"h")}var J=a(97);var Q=Object(I.a)(function(e){return{item:{opacity:.3},root:{backgroundColor:e.palette.background.paper},subheader:{backgroundColor:"#ead3d3",textAlign:"left"},subheader_total:{float:"right"},icon:{flexDirection:"column",fontSize:12}}}),B=function(e){var t=e.time,a=e.key,c=Object(n.useState)(0),i=Object(o.a)(c,2),l=i[0],u=i[1];!function(e,t){var a=Object(n.useRef)();Object(n.useEffect)(function(){a.current=e},[e]),Object(n.useEffect)(function(){if(null!==t){var e=setInterval(function(){a.current()},t);return function(){return clearInterval(e)}}},[t])}(function(){u(l+1)},15e3);var m=Date.now(),s=Q(),d=new Date(1e3*t);return r.a.createElement(j.a,{key:a,className:s.item},r.a.createElement(w.a,{primary:"Next at ".concat(H(d)),secondary:d>m&&W(d,m)}))},G=function(e){var t=e.groupedEntries,a=Date.now(),n=Q();return r.a.createElement(y.a,{disablePadding:!0,className:n.root},Object.entries(t).map(function(e){var t=Object(o.a)(e,2),c=t[0],i=t[1];return r.a.createElement(J.CSSTransitionGroup,{key:c,transitionName:"example",transitionEnterTimeout:500,transitionLeaveTimeout:300},r.a.createElement($.a,{className:n.subheader},Object(T.a)(parseInt(c,10),"d MMM, yyyy"),r.a.createElement("span",{className:n.subheader_total},"(total ",function(e){return e.filter(function(e){return!e.isSuggested}).length}(i),")")),i.map(function(e){var t=e.id,c=e.time,i=e.extra_food,o=e.meantime;return e.isSuggested?r.a.createElement(B,{key:t,time:c}):r.a.createElement(j.a,{key:t},r.a.createElement(_.a,{className:n.icon},i>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,null)," ",i,"ml"):null),r.a.createElement(w.a,{secondary:o},H(1e3*c)),r.a.createElement(D.a,null,a-1e3*c<864e5&&r.a.createElement(z.a,{edge:"end","aria-label":"Comments",component:l.b,to:"/edit/".concat(t)},r.a.createElement(M.a,null))))}))}))},P=a(106),U=a(46);function K(){var e=Object(f.a)(["\n  query getEntries($spaceId: String!) {\n    entries(spaceId: $spaceId) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return K=function(){return e},e}var V=b()(K());function X(){var e=Object(f.a)(["\n  query getEntry($id: String!) {\n    entry(id: $id) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return X=function(){return e},e}var Y=b()(X());function Z(){var e=Object(f.a)(["\n  mutation UpdateEntry($id: String!, $time: Int, $extra_food: Int) {\n    updateEntry(id: $id, time: $time, extra_food: $extra_food) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return Z=function(){return e},e}var ee=b()(Z());function te(){var e=Object(f.a)(["\n  mutation RemoveEntry($id: String!) {\n    removeEntry(id: $id) {\n      message\n      removedId\n    }\n  }\n"]);return te=function(){return e},e}var ae=b()(te());function ne(){var e=Object(f.a)(["\n  mutation CreateEntry($spaceId: String!, $time: Int!) {\n    createEntry(spaceId: $spaceId, time: $time) {\n      id\n      time\n      extra_food\n    }\n  }\n"]);return ne=function(){return e},e}var re=b()(ne());var ce=function(e){var t=e.spaceId,a=Object(p.a)(V,{variables:{spaceId:t}}),n=a.loading,c=a.data,i=a.error,l=!n&&!i,u=Object(g.a)(re,{refetchQueries:["getEntries"]}),m=Object(o.a)(u,2),f=m[0],E=m[1],b=E.loading,x=E.error,S=l&&c.entries.slice().sort(function(e,t){return t.time-e.time}),I=l&&S.reverse().reduce(function(e,t){if(e.length>0){var a=e[e.length-1];return[].concat(Object(d.a)(e),[Object(s.a)({},t,{meantime:W(new Date(1e3*t.time),new Date(1e3*a.time))})])}return[Object(s.a)({},t,{meantime:null})]},[]).reverse();if(I.length>0){var N=I[0],D=new Date(1e3*N.time),$=D.getHours(),_=$>=21||$<3?240:210;I.unshift({id:"future",time:Math.round(Object(U.a)(D,_)/1e3),extra_food:0,meantime:null,isSuggested:!0})}var z=I&&I.reduce(function(e,t){var a=Object(P.a)(new Date(1e3*t.time)).getTime();return e[a]=e[a]||[],e[a].push(t),e},{});return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"},(i||x)&&r.a.createElement(C,{message:i||x}),r.a.createElement(v.a,{variant:"contained",size:"large",color:"primary",onClick:function(){return f({variables:{time:Math.round(Date.now()/1e3),spaceId:t}})},disabled:b},"Now")),r.a.createElement(O.a,{maxWidth:"sm"},!n&&!i&&r.a.createElement(h.a,null,!n&&c&&c.entries.length>0&&r.a.createElement(G,{groupedEntries:z}),!n&&c&&0===c.entries.length&&r.a.createElement(y.a,null,r.a.createElement(j.a,null,r.a.createElement(w.a,{primary:"Click the button to start measuring intervals"})))),n&&r.a.createElement(k.a,null)))},ie=a(206),oe=a(203);var le=function(e){var t=e.onSelect,a=Object(n.useState)(""),c=Object(o.a)(a,2),i=c[0],l=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"}),r.a.createElement("form",{onSubmit:function(){return t(i)}},r.a.createElement(oe.a,{container:!0,spacing:5,direction:"column"},r.a.createElement(oe.a,{item:!0},r.a.createElement(ie.a,{label:"Space name",value:i,onChange:function(e){return l(e.target.value)},margin:"normal"})),r.a.createElement(oe.a,{item:!0},r.a.createElement(v.a,{type:"submit",variant:"contained",color:"primary"},"Proceed")))))},ue=a(107),me=function(e){var t=e.onLogin,a=function(e){console.log(e),t(e)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"}),r.a.createElement(ue.GoogleLogin,{clientId:"299114443733-g59vv11262camtp97hiv99sjh0qr3b9i.apps.googleusercontent.com",buttonText:"Login",onSuccess:a,onFailure:a,isSignedIn:!0,cookiePolicy:"single_host_origin"}))},se=a(110),de=a(109),fe=a(70),Ee=a(69),be=a(108),pe=a(50),ge=a(204),ve=a(209),he=a(71),Oe=a.n(he),ye=a(72),je=a.n(ye),we=a(211);function ke(e){var t=null,a=!1;return function(){for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];a?t=function(){return e.apply(void 0,r)}:function e(n){a=!0,n().then(function(){if(a=!1,null!=t){var n=t;t=null,e(n)}})}(function(){return e.apply(void 0,r)})}}var xe=Object(I.a)(function(e){return Object(we.a)({root:{padding:e.spacing(3,5)}})});var Se=function(e){var t=e.spaceId,a=e.match.params.id,c=Object(p.a)(Y,{variables:{id:a}}),i=c.loading,l=c.data,d=Object(g.a)(ae,{variables:{id:a},update:function(e,a){var n=a.data.removeEntry,r=null;try{r=e.readQuery({query:V,variables:{spaceId:t}})}catch(c){}r&&e.writeQuery({query:V,variables:{spaceId:t},data:{entries:r.entries.filter(function(e){return e.id!==n.removedId})}})}}),f=Object(o.a)(d,2),E=f[0],b=f[1].data,y=Object(n.useState)(null),j=Object(o.a)(y,2),w=j[0],x=j[1],S=Object(n.useState)(null),I=Object(o.a)(S,2),N=I[0],C=I[1],D=Object(m.b)(),$=Object(n.useCallback)(ke(function(e){return D.mutate({mutation:ee,variables:Object(s.a)({id:a},e)})}),[D,a]);null!==w||i||x(new Date(1e3*l.entry.time)),null!==N||i||C(l.entry.extra_food);var _,z=function(e){x(e),$({time:Math.round(e.getTime()/1e3)})},A=xe();return b?r.a.createElement(u.a,{to:"/"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"},!i&&r.a.createElement(pe.a,null,H(w)," ",(_=w,Object(T.a)(new Date(_),"d MMM, yyyy")))),r.a.createElement(O.a,{maxWidth:"sm"},i?r.a.createElement(k.a,null):r.a.createElement(oe.a,{container:!0,spacing:2,direction:"row",justify:"center"},r.a.createElement(oe.a,{item:!0,xs:12,md:4},r.a.createElement(h.a,{className:A.root},r.a.createElement(pe.a,{paragraph:!0},"Day"),r.a.createElement(ge.a,{color:"primary","aria-label":"Add",size:"small",onClick:function(){return z(Object(Ee.a)(w,1))}},r.a.createElement(Oe.a,null)),r.a.createElement(ge.a,{color:"primary","aria-label":"Remove",size:"small",onClick:function(){return z(Object(be.a)(w,1))}},r.a.createElement(je.a,null)))),r.a.createElement(oe.a,{item:!0,xs:12,md:4},r.a.createElement(h.a,{className:A.root},r.a.createElement(pe.a,{paragraph:!0},"Hours"),r.a.createElement(ge.a,{color:"primary","aria-label":"Add",size:"small",onClick:function(){return z(Object(fe.a)(w,1))}},r.a.createElement(Oe.a,null)),r.a.createElement(ge.a,{color:"primary","aria-label":"Remove",size:"small",onClick:function(){return z(Object(de.a)(w,1))}},r.a.createElement(je.a,null)))),r.a.createElement(oe.a,{item:!0,xs:12,md:4},r.a.createElement(h.a,{className:A.root},r.a.createElement(pe.a,{paragraph:!0},"Minutes"),r.a.createElement(ge.a,{color:"primary","aria-label":"Add",size:"small",onClick:function(){return z(Object(U.a)(w,5))}},r.a.createElement(Oe.a,null)),r.a.createElement(ge.a,{color:"primary","aria-label":"Remove",size:"small",onClick:function(){return z(Object(se.a)(w,5))}},r.a.createElement(je.a,null)))),r.a.createElement(oe.a,{item:!0,xs:12,md:12},r.a.createElement(h.a,{className:A.root},r.a.createElement(pe.a,{paragraph:!0},"Extra food - ",N,"ml"),r.a.createElement(ve.a,{defaultValue:N,"aria-labelledby":"discrete-slider",valueLabelDisplay:"off",step:5,min:0,max:150,onChange:function(e,t){return function(e){C(e),$({extra_food:e})}(t)}}))),r.a.createElement(oe.a,{item:!0,xs:12,md:12},r.a.createElement(h.a,{className:A.root},r.a.createElement(pe.a,{paragraph:!0},"Danger zone"),r.a.createElement(v.a,{variant:"contained",color:"secondary",onClick:E},"Delete"))))))},Ie=a(205),Ne=Object(I.a)(function(e){return Object(we.a)({root:{padding:e.spacing(5,2)}})}),Ce=function(){var e=Ne();return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"},"ERROR 404"),r.a.createElement(O.a,{className:e.root,maxWidth:"sm"},r.a.createElement(pe.a,{variant:"h5",paragraph:!0},"NOT FOUND"),r.a.createElement(pe.a,{variant:"body"},"Go back to the ",r.a.createElement(Ie.a,{to:"/",component:l.b},"homepage"))))},De=a(45),$e=a(114),_e=a(113),ze=a(111);function Ae(e){var t=Object($e.a)({uri:"https://papi.ertrzyiks.me/food-time"}),a=Object(ze.a)(function(t,a){var n=a.headers;return{headers:Object(s.a)({},n,{authorization:"Bearer ".concat(e)})}});return new De.a({cache:new _e.a({cacheRedirects:{Query:{entry:function(e,t,a){return(0,a.getCacheKey)({__typename:"Entry",id:t.id})}}}}),link:a.concat(t)})}a(151);var Me=function(e){var t=e.storage,a=t.read,c=t.write,i=Object(n.useState)(a("food-time-space-id")),s=Object(o.a)(i,2),d=s[0],f=s[1],E=Object(n.useState)(null),b=Object(o.a)(E,2),p=b[0],g=b[1];return Object(n.useEffect)(function(){c("food-time-space-id",d)},[d,c]),r.a.createElement("div",{className:"App"},r.a.createElement(l.a,null,r.a.createElement(u.d,null,p?r.a.createElement(m.a,{client:Ae(p.tokenId)},d?r.a.createElement(r.a.Fragment,null,r.a.createElement(u.b,{exact:!0,path:"/",render:function(){return r.a.createElement(ce,{spaceId:d})}}),r.a.createElement(u.b,{path:"/edit/:id",render:function(e){return r.a.createElement(Se,Object.assign({},e,{spaceId:d}))}})):r.a.createElement(u.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(le,Object.assign({},e,{onSelect:function(e){return f(e)}}))}})):r.a.createElement(u.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(me,Object.assign({},e,{onLogin:function(e){return g(e)}}))}}),r.a.createElement(u.b,{component:Ce}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Me,{storage:{read:function(e){return JSON.parse(window.localStorage.getItem(e))},write:function(e,t){return window.localStorage.setItem(e,JSON.stringify(t))}}}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[120,1,2]]]);
//# sourceMappingURL=main.817aa879.chunk.js.map